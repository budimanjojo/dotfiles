{{ if (and (eq .chezmoi.os "linux") (eq .chezmoi.osRelease.id "debian" "ubuntu")) -}}
#!/bin/bash

set -eufo pipefail

repositories=(
    ppa:fish-shell/release-3
)
packages=(
    fish
    neovim
    tmux
    curl
    python3-neovim
    git
    fd-find
    bat
    thefuck
)
snaps=()

{{ if (not .headless) -}}
packages+=(
    alacritty
)
{{ end -}}

for repository in ${repositories[@]}; do
{{ if ne .chezmoi.username "root" -}}
    sudo add-apt-repository -y $repository
{{ else -}}
    add-apt-repository -y $repository
{{ end -}}
done

{{ if ne .chezmoi.username "root" -}}
sudo apt update

sudo apt install -y ${packages[@]}
{{ else -}}
apt update

apt install -y ${packages[@]}
{{ end -}}

{{ if (eq .chezmoi.osRelease.id "ubuntu") -}}
for snap in ${snaps[@]}; do
{{   if ne .chezmoi.username "root" -}}
    sudo snap install $snap
{{   else -}}
    snap install $snap
{{   end -}}
done
{{ end -}}

{{ end -}}
